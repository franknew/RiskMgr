<!--
包含list页所需所有tmpl
-->
<script type="text/html" id="ListContainer">
<div class="block-flat">
	<form id="J_SearchForm" class="form-horizontal">
			<div class="form-group">
				<label class="col-sm-2 control-label">单据状态</label>
				<div class="col-sm-2">
					<select class="form-control" name="Status">
						<option value="">全部</option>
						<option value="2" selected="selected">流程中</option>
						<option value="6">保后跟踪中</option>
						<option value="4">已终审（经理通过）</option>
						<option value="5">审批不通过</option>
						<option value="3">已确认回款</option>
					</select>
				</div>
				<label class="col-sm-2 control-label">编号</label>
				<div class="col-sm-2">
					<input type="text" name="BusinessCode" class="form-control" placeholder="">
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label">业务员</label>
				<div class="col-sm-2">
					<input type="text" name="Operator" class="form-control" placeholder="">
				</div>
				<label class="col-sm-2 control-label">客户姓名</label>
				<div class="col-sm-2">
					<input type="text" name="Name" class="form-control" placeholder="">
				</div>
				<label class="col-sm-2 control-label">房产证号</label>
				<div class="col-sm-2">
					<input type="text" name="IdentityCode" class="form-control" placeholder="">
				</div>
			</div>
			<div class="form-group">
				<div class="col-md-2 col-md-offset-2"><button type="submit" class="btn btn-default btn-flat" data-hook="search">查找</button></div>
			</div>
	</form>
	<hr/>
	<div id="ListContainer">
		<div class="loading">Loading...</div>
	</div>
</div>
</script>

<script type="text/html" id="List">
	<table class="no-border">
		<thead class="no-border">
			<tr>
				<th>编号</th>
				<th>业务员</th>
				<th>客户名称</th>
				<th>房产地址</th>
				<th>申请时间</th>
				<th>状态</th>
			</tr>
		</thead>
		<tbody class="no-border-x no-border-y" id="J_Lister">
			<%=this.ListItem(data)%>
		</tbody>
	</table>

	<div class="j-pager"></div>

</script>

<script type="text/html" id="ListItem">
<%
	var RString = require('risk/unit/string');
	var List = data||[];

	var i=0,Cur;
	if (List.length>0) {

		for(;Cur=List[i++];) {
%>
	<tr data-hook="view" class="pointer-item" data-id="<%=Cur.Project.ID%>" data-workflowid="<%=Cur.WorkflowID%>" data-activityid="<%=Cur.CurrentActivity&&Cur.CurrentActivity.ID%>" data-taskid="<%=Cur.TaskID%>">
		<td><%=Cur.Project.Name%></td>
		<td><%=Cur.Creator||'&nbsp;'%></td>
		<td>
			<table class="no-strip">

			<%
			var bi=0,CurBuyer,
				Buyers = Cur.Buyers||[];
			for(;CurBuyer=Buyers[bi++];) {
			%>
			<tr>
				<td class="col-sm-4 text-success"><small>[<%=((Cur.Sellers&&Cur.Sellers.length>=1)?'买':'客户')%>]</small> <%=CurBuyer.Name%></td>
			</tr>
			<%
			}
			%>

			<%
			var bi=0,CurSeller,
				Sellers = Cur.Sellers||[];
			for(;CurSeller=Sellers[bi++];) {
			%>
			<tr>
				<td class="col-sm-4 text-danger"><small>[卖]</small> <%=CurSeller.Name%></td>
			</tr>
			<%
			}
			%>

			</table>
		</td>
		<td>
			<table class="no-strip">
			<%
			var bi=0,CurAssets,
				Assets = Cur.Assets||[];
			for(;CurAssets=Assets[bi++];) {
			%>
			<tr>
				<td><%=CurAssets.Address%></td>
			</tr>
			<%
			}
			%>
			</table>
		</td>
		<td><%=RString.date(Cur.Project.CreateTime,'yyyy-MM-dd HH:mm:ss')%></td>
		<td><%=Cur.WorkflowComplete?'已回款':(Cur.CurrentActivity && Cur.CurrentActivity.Name)%></td>
	</tr>
<%
		}
	}else{
%>
	<tr>
	<td colspan="5">
		<div class="alert alert-info" role="alert">没有业务信息</div>
	</td>
	</tr>
<%
	}
%>
</script>