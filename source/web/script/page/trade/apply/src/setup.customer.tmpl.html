<script type="text/html" id="SetupCustomer">
	<%
		var FormData = data.data || {},
			TradeType = FormData.Type;
		var OnlyOne = !!($.inArray(TradeType,[3,4]) != -1),	//只有一种客户的交易类型
			BuyerText = OnlyOne?'客户':'买家';
	%>
	<div class="step-pane" id="Customer">
		<div class="block-transparent">
			<div class="header">
				<h3><%=BuyerText%> <%if (data.canEdit) {%><button type="button" class="btn btn-default" data-hook="customer-import"><i class="fa fa-sign-in"></i> 导入现有客户</button><%}%></h3>
			</div>
			<div class="content">
				<div class="list-group tickets" id="BuyerList">
					<%
						var Buyer = FormData.Buyers||[];
						var i=0, l = Buyer.length||1;
						for(; i < l; ++i) {
					%>
						<%=this.CustomerItem({
							data:Buyer[i],
							tpl:data.customerTpl,
							canEdit:data.canEdit
						})%>
					<%
						}
					%>
				</div>

				<%if (data.canEdit) {%>
					<button type="button" class="btn btn-success" data-hook="customer-add">&nbsp;&nbsp;<i class="fa fa-plus"></i> 增加<%=BuyerText%>&nbsp;&nbsp;</button>
				<%}%>
			</div>
		</div>

		<%
		if (!OnlyOne) {	//判断交易类型才显示卖家
		%>
		<div class="block-transparent">
			<div class="header">
				<h3>卖家 <%if (data.canEdit) {%><button type="button" class="btn btn-default" data-hook="customer-import"><i class="fa fa-sign-in"></i> 导入现有客户</button><%}%></h3>
			</div>
			<div class="content">
				<div class="list-group tickets" id="SellerList">

					<%
						var Sellers = FormData.Sellers||[];
						var i=0, l = Sellers.length||1;
						for(; i < l; ++i) {
					%>
						<%=this.CustomerItem({
							data:Sellers[i],
							tpl:data.customerTpl,
							canEdit:data.canEdit
						})%>
					<%
						}
					%>
				</div>
				<%if (data.canEdit) {%>
				<button type="button" class="btn btn-success" data-hook="customer-add">&nbsp;&nbsp;<i class="fa fa-plus"></i> 增加卖家&nbsp;&nbsp;</button>
				<%}%>
			</div>
		</div>
		<%}%>

		<%if (data.canEdit) {%>
		<div class="form-group">
			<div class="text-center col-sm-12">
				<button class="btn btn-default wizard-cancel" data-hook="cancel">取消</button>
				&nbsp;&nbsp;
				<button class="btn btn-primary wizard-next">下一步 <i class="fa fa-caret-right"></i></button>
			</div>
		</div>
		<%}%>
	</div>
</script>

<script type="text/html" id="CustomerItem">
	<div class="list-group-item">
		<%=data.tpl(data.data,data.canEdit)%>
		<%
			if (data.canEdit) {
		%>
			<hr style="border-bottom:1px dashed #dadada"/>
			<div class="col-sm-offset-2">
				<button type="button" class="btn btn-danger" data-hook="customer-remove">移除</button>
			</div>
		<%
			}
		%>
	</div>
</script>