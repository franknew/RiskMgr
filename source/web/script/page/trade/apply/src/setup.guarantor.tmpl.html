<script type="text/html" id="SetupGuarantor">
<%
	var FormData = data.data || {};
%>
<div class="step-pane" id="Guarantor">
	<div class="block-transparent">
		<div class="header">
			<h3>担保人 <%if (data.canEdit) {%><button type="button" class="btn btn-default" data-hook="guarantor-import"><i class="fa fa-sign-in"></i> 导入现有客户</button><%}%></h3>
		</div>
		<div class="content">
			<div class="list-group tickets" id="GuarantorBase">
				<%=this.GuarantorItemsBox(data)%>
			</div>
			<%if (data.canEdit) {%>
			<button type="button" class="btn btn-success" data-hook="guarantor-add">&nbsp;&nbsp;<i class="fa fa-plus"></i> 增加担保人&nbsp;&nbsp;</button>
			<%}%>
		</div>
	</div>

	<%if (data.canEdit) {%>
	<div class="form-group">
		<div class="text-center col-sm-12">
			<button class="btn btn-default wizard-previous"><i class="fa fa-caret-left"></i> 上一步</button>
			&nbsp;&nbsp;
			<button class="btn btn-primary wizard-next">下一步 <i class="fa fa-caret-right"></i></button>
		</div>
	</div>
	<%}%>
</div>
</script>

<script type="text/html" id="GuarantorItemsBox">
<%
	var FormData = data.data || {},
		Guarantors = FormData.Guarantor,
		CanEdit = data.canEdit;
%>

<%
if (Guarantors&&Guarantors.length>0) {
	var i=0,cur;
	for(;cur=Guarantors[i++];) {
%>
	<%=this.GuarantorItem({
		canEdit:data.canEdit,
		data:cur
	})%>
<%
	}
}else if(!CanEdit) {
%>
	<div class="alert alert-info">
		无担保人信息
	</div>
<%
}
%>

</script>

<script type="text/html" id="GuarantorItem">
<%
	var Former = require('risk/components/former/index'),
		TplCustomer = require('risk/page/customer/tpl.view');
	var CanEdit = data.canEdit,
		GuarantorData = data&&data.data;

	console.log('GuarantorData',GuarantorData);
%>

	<div class="list-group-item">
		<div class="j-guarantor-form">
			<%=Former.make(TplCustomer,{
				data:GuarantorData,
				disabled:!CanEdit,
				onlyRequired:true
			})%>

			<%/**手动增加一个备注表单**/%>
			<%=Former.make([[{
				type:'label',
				col:2,
				html:'备注'
			},{
				col:'10',
				type:'textarea',
				name:'Remark',
				placeholder:''
			}]],{
				data:GuarantorData,
				disabled:!CanEdit
			})%>

		</div>
		<hr style="border-bottom:1px dashed #dadada"/>
		<div class="col-sm-offset-2 j-guarantor-house">

			<%=this.GuarantorPropertyItem({
				canEdit:CanEdit,
				data:(GuarantorData&&GuarantorData.Assets)
			})%>

		</div>

		<%if (data.canEdit) {%>
		<div class="col-sm-offset-2">
			<button class="btn btn-default" data-hook="guarantor-addhouse"><i class="fa fa-plus"></i>增加房产</button>
			<button type="button" class="btn btn-default" data-hook="guarantor-import-house"><i class="fa fa-sign-in"></i> 导入现有房产</button>
		</div>
		<%}%>

		<%if (data.canEdit) {%>
		<hr style="border-bottom:1px dashed #dadada"/>
		<div class="col-sm-offset-1">
			<button type="button" class="btn btn-danger" data-hook="guarantor-remove">移除该担保人</button>
		</div>
		<%}%>
	</div>
</script>
<script type="text/html" id="GuarantorPropertyItem">
<%
	var Former = require('risk/components/former/index'),
		TplProperty = require('risk/page/Property/tpl.view');
	var CanEdit = data.canEdit,
		PropertyList = data&&data.data || (CanEdit?[1]:[]);//可编辑状态，默认空白一个item
%>
<%
	var i=0,cur;
	for(;cur=PropertyList[i++];) {
%>
	<div class="well well-sm j-houseitem">
		<%=Former.make(TplProperty,{
			data:cur,
			disabled:!CanEdit,
			onlyRequired:true
		})%>
		<%if (CanEdit) {%>
		<div class="col-sm-offset-1">
			<button type="button" class="btn btn-danger btn-xs" data-hook="guarantor-removehouse">移除该房产</button>
		</div>
		<%}%>
	</div>
<%
	}
%>
</script>