<script type="text/html" id="SetupProject">
<%
	var Former = require('risk/components/former/index'),
		FormData = data.data||{},
		FormType = FormData.Type*1,
		CanEdit = data.canEdit;
%>
<div class="step-pane" id="Project">
	<div class="block-transparent">
		<div class="header">
			<h3>项目信息</h3>
		</div>
		<div class="content">
			<div class="well">
				<div class="header">
				<h4>基本情况</h4>
				</div>
				<%=Former.make(require('./tpl.project.base'),{
					data:FormData.Project,
					disabled:!CanEdit
				})%>
			</div>
			<div class="well">
				<div class="header">
				<h4>赎楼行</h4>
				</div>
				<%=Former.make(require('./tpl.project.ransombank'),{
					data:FormData.Project,
					disabled:!CanEdit,
					tplFilter:function(tpl) {
						var rs = $.extend({},tpl);
							name = tpl.name || (tpl.type=='label' && tpl.html),
							type = FormData.Type*1;

						switch(type) {
							case 2: //首期款垫付
								//首期款垫付没有这些字段
								if ($.inArray(name, ['用款期限','GuaranteeMonth','赎楼金额','AssetRansomMoney']) != -1) {
									rs = false;
								}
								break;
							case 4: //贷前垫资,全部都非必填
								rs.required = false;
								break;
						}

						return rs;
					}
				})%>
			</div>
			<div class="well">
				<div class="header">
				<h4>新贷款资料</h4>
				</div>
				<%=Former.make(require('./tpl.project.newloan'),{
					data:FormData.Project,
					disabled:!CanEdit,
					tplFilter:function(tpl) {
						var rs = $.extend({},tpl);
							name = tpl.name || (tpl.type=='label' && tpl.html),
							type = FormData.Type*1,
							//同名转贷、贷前垫资的不同的字段
							specKeys = ['买方贷款金额','BuyerCreditCommerceMoney','BuyerCreditFundMoney','成交金额','DealMoney','交易定金','EarnestMoney','资金监管','SupervisionMoney','资金监管银行','SupervisionBank'];	//同名转按没有这些，贷前垫资这些改为非必填

						if ($.inArray(name, specKeys) != -1) {
							switch(type) {
								case 3: //同名转按
									rs = false;
									break;
								case 4: //贷前垫资
									rs.required = false;
									break;
							}
						}

						//只有贷前垫资才显示“垫资金额”
						if (type!=4 && !!~$.inArray(name,['垫资金额','CompanyPredepositMoney'])) {
							rs = false;
						}

						return rs;
					}
				})%>
			</div>
			<%
			if (FormType!=2) {	//首期款垫付没有赎楼方式
			%>
			<div class="well">
				<div class="header">
				<h4>赎楼方式</h4>
				</div>
				<%=Former.make(require('./tpl.project.ransomway'),{
					data:FormData.Project,
					disabled:!CanEdit
				})%>
			</div>
			<%}%>
		</div>
	</div>
	<%if (data.canEdit) {%>
	<div class="form-group">
		<div class="text-center col-sm-12">
			<button class="btn btn-default wizard-previous"><i class="fa fa-caret-left"></i> 上一步</button>
			&nbsp;&nbsp;
			<button class="btn btn-primary wizard-next">下一步 <i class="fa fa-caret-right"></i></button>
		</div>
	</div>
	<%}%>
</div>
</script>